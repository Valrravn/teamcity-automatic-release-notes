# TeamCity Autogenerated Release Notes

## Mandatory parameters

* `TeamCity version` — shows a list of versions matching `project: TeamCity` on YouTrack. Relies on an external plugin by Grigory Chernyshev: https://plugins.jetbrains.com/plugin/9076-web-parameters
* `env.repo_branch` — the repository branch where the config should write files and send a pull request.

## Optional parameters

* `Release date` — the release date in the "d MMMM yyyy" format (for example, "2 March 2028"). Specify manually if collecting Release Notes beforehand, or updating already published Release Notes. Leave empty to insert the `DateTime.Now` date.
* `file-name` (Hidden parameter) — automatically set to the "teamcity-year-major-minor-release-notes.md" value based on the short TC version parameter. Unhide this param to be able to override it.
* `Short TeamCity version` (Hidden parameter, superseded by autopopulated list of TC versions) — TC version in the "year.major.minor" format. For example, "2025.03" or "2024.12.2".
* `Build number` (Hidden parameter, superseded by autopopulated list of TC versions) — if set, will be added to the `short TC version`. YouTrack REST API calls will then use `{short_version (build_number)}` version instead of simply `short_version`. This parameter can be unknown at the time RNs are generated, hence optionality.

## Password parameters

Set these parameters when deploying this config on your local machine.

* `env.GITHUB_TOKEN` — your GitHub.com access token
* `env.YT_TOKEN` — bearer token for retrieving YouTrack issues

## YouTrack Queries

* Non-security issues — `query=Project:%20TeamCity%20Fix%20versions:%20%full-version-escaped%%20visible%20to:%20%7BAll%20Users%7D%20%23Fixed%20%23Testing%20-%7BTrunk%20issue%7D`. The `full-version-escaped` parameter is calculated from combining `short-version` and `build-number` parameters, and applying the `Uri.EscapeDataString` method.
* Security issues — `"query": "project: TeamCity Fix versions: %full-version%  #Testing #Fixed -{Trunk issue} #{Security Problem}"`

Queries are in different formats since non-security issues are retrieved by sending `GET` to the `api/issues` endpoint (we need issues themselves), and security issues are loaded by sending `POST` to the `/api/issuesGetter/count` endpoint (we don't need these issues, only the total count)
